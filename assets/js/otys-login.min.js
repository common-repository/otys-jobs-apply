"use strict";{document.querySelectorAll('[name="otys-login-form"]').forEach((t=>{t.addEventListener("submit",(r=>(r.preventDefault(),e(t,r),!1)))}));const e=async e=>{let t=e.reportValidity();const r=e.getAttribute("data-identifier");if(!t)return;e.classList.add("loading"),e.querySelectorAll(".input_errors").forEach((e=>{e.innerHTML=""})),e.querySelectorAll(".rest-form-footer-errors").forEach((e=>{e.innerHTML=""})),e.querySelectorAll(".invalid").forEach((e=>{e.classList.remove("invalid")}));let o=new FormData(e);const l=await fetch(e.getAttribute("action"),{method:"POST",body:o}),n=await l.json();if(document.dispatchEvent(new CustomEvent("otys-rest-form-callback",{detail:{formData:o,response:n,status:l.status}})),200===l.status){if(void 0!==n.redirect)return void(window.location.href=n.redirect.value);if(e.classList.add("success"),e.classList.remove("loading"),"content"in document.createElement("template")){const t=e.querySelectorAll(".rest-form-container")[0],r=e.querySelectorAll(".rest-form-success"),o=r.length?r[0]:null;if(o){const e=o.content.cloneNode(!0);e.querySelectorAll('.rest-form-page[data-type="success"]').forEach((e=>{e.classList.add("current")})),t.appendChild(e)}}}if(500===l.status){console.log(n.code);const t=e.querySelectorAll(".rest-form-footer-errors"),r=t.length?t[0]:null;if(console.log(t),console.log(r),r&&"content"in document.createElement("template")){const t=e.querySelectorAll(".input-error-template"),o=t.length?t[0]:null;if(o){let e=o.content.cloneNode(!0),t=e.querySelectorAll(".input_error");null!==t&&t.forEach((e=>{e.innerHTML=n.message})),console.log(t),r.appendChild(e),console.log(r)}}}if(!l.ok&&(400===l.status||409===l.status)){const t=Object.keys(n);let o=!1;t.forEach((t=>{const l=n[t],s=t+r,c=document.getElementById(s);let a=document.getElementById("input-errors-"+s);if(null===a){const t=e.querySelectorAll(".rest-form-footer-errors");a=t.length?t[0]:null}if(l.errors&&l.errors.length){if(a.classList.add("invalid"),c&&(c.classList.add("invalid"),!1===o&&null!==a)){let t=c.closest(".rest-form-page");if(t&&null!==t){o=!0,e.querySelectorAll(".rest-form-page").forEach((e=>{e.classList.remove("current")})),t.classList.add("current"),window.scrollTo({behavior:"smooth",top:c.getBoundingClientRect().top-document.body.getBoundingClientRect().top-80})}}l.errors.forEach((t=>{if("content"in document.createElement("template")){const r=e.querySelectorAll(".input-error-template"),o=r.length?r[0]:null;if(o){let e=o.content.cloneNode(!0),r=e.querySelectorAll(".input_error");null!==r&&r.forEach((e=>{e.innerHTML=t})),a.appendChild(e)}}}))}else c&&(c.classList.remove("invalid"),c.classList.add("valid"))})),addFormAttributes(e),toggleButtons(e)}return grecaptcha.ready((function(){const t=e.querySelectorAll(".g-recaptcha");t.length&&t.forEach((e=>{const t=e.getAttribute("data-sitekey");grecaptcha.execute(t,{action:"submit"}).then((e=>{}))}))})),e.classList.remove("loading"),n}}